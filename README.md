# Обнаружение атак Mirai в IoT-трафике

Этот Jupyter-ноутбук демонстрирует полный процесс построения и интерпретации классификатора для обнаружения атак семейства Mirai в сетевом трафике IoT-устройств. В работе используются метрики качества модели и объяснение предсказаний с помощью SHAP-значений.

Ссылка на датасет: [IoT Intrusion Detection Dataset на Kaggle](https://www.kaggle.com/datasets/subhajournal/iotintrusion/data)\
Файл данных: `IoT_Intrusion.csv`

---

## Структура проекта

1. **Загрузка и предварительный анализ данных**

   - Чтение `IoT_Intrusion.csv`
   - Анализ распределения меток: `benign` и различные атаки, фильтрация только Mirai vs benign

2. **Предобработка**

   - Удаление пропусков и аномалий
   - Кодирование категориальных признаков
   - Масштабирование числовых признаков (`StandardScaler` или `MinMaxScaler`)

3. **Построение классификатора**

   - Разделение данных на обучающую и тестовую выборки
   - Обучение `RandomForestClassifier` (или другого алгоритма)
   - Оценка метрик: accuracy, precision, recall, f1-score
   - Вывод матрицы ошибок и отчёта классификации

4. **Интерпретация модели с SHAP**

   - Создание объяснителя: `shap.TreeExplainer(model)`
   - Вычисление SHAP-значений для тестовых примеров
   - **Summary plot** и **bar plot** важности признаков
   - Построение локальных объяснений для отдельных примеров (force plot)

5. **Визуализация и анализ**

   - Таблица влияния признаков на вероятность Mirai-атаки
   - Графики SHAP с интерпретацией (цветовое кодирование высоких/низких значений)

6. **Выводы**

   - Описание ключевых признаков, влияющих на классификацию Mirai-атак
   - Рекомендации для практического применения детектирования атак

---

## Быстрый старт

1. **Клонировать репозиторий** или скачать ноутбук и датасет в одну папку.
2. **Создать виртуальное окружение** и активировать его:
   ```bash
   python3 -m venv venv
   source venv/bin/activate      # macOS/Linux
   .\venv\Scripts\activate     # Windows PowerShell
   ```
3. **Установить зависимости**:
   ```bash
   pip install -r requirements.txt
   ```
4. **Запустить Jupyter Notebook**:
   ```bash
   jupyter notebook
   ```
5. Открыть `Mirai_detection.ipynb` и выполнить ячейки сверху вниз.

---

## requirements.txt

```text
pandas>=1.3.0
numpy>=1.21.0
scikit-learn>=1.0.0
matplotlib>=3.4.0
seaborn>=0.11.0
shap>=0.41.0
```

